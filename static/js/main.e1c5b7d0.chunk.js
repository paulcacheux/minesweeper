(this.webpackJsonpminesweeper=this.webpackJsonpminesweeper||[]).push([[0],{16:function(e,t,n){e.exports=n(32)},21:function(e,t,n){},27:function(e,t,n){},28:function(e,t,n){},29:function(e,t,n){},30:function(e,t,n){},31:function(e,t,n){},32:function(e,t,n){"use strict";n.r(t);var a,r=n(0),i=n.n(r),o=n(6),l=n.n(o),c=(n(21),n(1));!function(e){e[e.playing=0]="playing",e[e.overWin=1]="overWin",e[e.overLose=2]="overLose"}(a||(a={}));var s="CLICK_CELL",u="FLAG_CELL",h="NEW_GAME",f="CHANGE_LEFT_CLICK_TOOL";function g(e,t){return{type:u,x:e,y:t}}var v=n(7),m=function(){var e=Object(c.c)((function(e){return e.startDate})),t=Object(r.useState)(0),n=Object(v.a)(t,2),a=n[0],o=n[1];return Object(r.useEffect)((function(){var t=setInterval((function(){if(void 0!==e)if("number"===typeof e)o(e);else{var t=((new Date).getTime()-e.getTime())/1e3,n=Math.round(t);o(n)}}),500);return function(){clearInterval(t)}})),i.a.createElement("p",{className:"score-like"},a)},d=function(e){var t=e.game.board,n=t.bombCount-t.flagCount();return{gameState:e.game.gameState,minesLeft:n}},b=function(e){var t,n=Object(c.b)(),r=Object(c.c)(d),o=r.gameState,l=r.minesLeft;switch(o){case a.playing:t="happy_face.png";break;case a.overWin:t="glass_face.png";break;case a.overLose:t="sad_face.png"}return i.a.createElement("header",null,i.a.createElement("h1",null,"Minesweeper"),i.a.createElement("ul",{className:"cmd-box"},i.a.createElement("li",null,i.a.createElement("p",null,"Time:"),i.a.createElement(m,null)),i.a.createElement("li",{id:"restart"},i.a.createElement("button",{className:"cell",title:"New Game",onClick:function(){return n({type:h})}},i.a.createElement("img",{id:"img-button",alt:"New Game",src:"/minesweeper/img/"+t}))),i.a.createElement("li",null,i.a.createElement("p",null,"Mines:"),i.a.createElement("p",{className:"score-like"},l))),e.children)},p=n(4),y=n(15),w=n(8),E=n(12),k=n(5);var C=function(e){return Array.from({length:e},(function(e,t){return t}))},O=function(){function e(t,n){Object(k.a)(this,e),this.x=t,this.y=n}return Object(E.a)(e,[{key:"isEqualTo",value:function(e){return this.x===e.x&&this.y===e.y}}]),e}();function S(e,t){var n=!0,a=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var l=i.value;if(t.isEqualTo(l))return!0}}catch(c){a=!0,r=c}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}return!1}var j=function(){function e(t,n,a){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];Object(k.a)(this,e),this.width=void 0,this.height=void 0,this.bombCount=void 0,this.content=void 0,this.pushState=void 0,this.flags=void 0,this.errorCell=void 0,this.width=t,this.height=n,this.bombCount=a,this.content=new Array(this.width*this.height).fill(0),this.pushState=new Array(this.width*this.height).fill(!1),this.flags=[],r&&this.randomFill()}return Object(E.a)(e,[{key:"clone",value:function(){var t=new e(this.width,this.height,this.bombCount,!1);return t.content=Object(w.a)(this.content),t.pushState=Object(w.a)(this.pushState),t.flags=Object(w.a)(this.flags),t}},{key:"randomFill",value:function(){var e=function(e,t){for(var n,a,r=e.slice(0),i=e.length;i--;)n=r[a=Math.floor((i+1)*Math.random())],r[a]=r[i],r[i]=n;return r.slice(0,t)}(C(this.content.length),this.bombCount),t=!0,n=!1,a=void 0;try{for(var r,i=e[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value;this.content[o]="bomb"}}catch(d){n=!0,a=d}finally{try{t||null==i.return||i.return()}finally{if(n)throw a}}for(var l=0;l<this.height;l++)for(var c=0;c<this.width;c++)if(!this.isBomb(c,l)){var s=0,u=!0,h=!1,f=void 0;try{for(var g,v=this.buildNeighbors(c,l)[Symbol.iterator]();!(u=(g=v.next()).done);u=!0){var m=g.value;this.isBomb(m.x,m.y)&&(s+=1)}}catch(d){h=!0,f=d}finally{try{u||null==v.return||v.return()}finally{if(h)throw f}}this.content[this.buildIndex(c,l)]=s}}},{key:"buildIndex",value:function(e,t){return t*this.width+e}},{key:"buildNeighbors",value:function(e,t){for(var n=[],a=0,r=[[-1,-1],[0,-1],[1,-1],[1,0],[1,1],[0,1],[-1,1],[-1,0]];a<r.length;a++){var i=r[a],o=Object(v.a)(i,2),l=e+o[0],c=t+o[1];this.checkInBounds(l,c)&&n.push(new O(l,c))}return n}},{key:"isBomb",value:function(e,t){return"bomb"===this.getCellContent(e,t)}},{key:"getCellContent",value:function(e,t){return this.assertInBounds(e,t),this.content[this.buildIndex(e,t)]}},{key:"getPushState",value:function(e,t){return this.assertInBounds(e,t),this.pushState[this.buildIndex(e,t)]}},{key:"setFlag",value:function(e,t,n){this.assertInBounds(e,t);var a=new O(e,t);n&&!S(this.flags,a)?this.flags.push(a):n||this.clearFlag([new O(e,t)])}},{key:"flagCount",value:function(){return this.flags.length}},{key:"clearFlag",value:function(e){this.flags=this.flags.filter((function(t){return!S(e,t)}))}},{key:"isFlagged",value:function(e,t){return this.assertInBounds(e,t),S(this.flags,new O(e,t))}},{key:"isWin",value:function(){for(var e=0;e<this.height;e++)for(var t=0;t<this.width;t++)if("bomb"!==this.getCellContent(t,e)&&!this.getPushState(t,e))return!1;return!0}},{key:"switchToFailState",value:function(e,t){for(var n=0;n<this.height;n++)for(var a=0;a<this.width;a++)"bomb"===this.getCellContent(a,n)&&(this.pushState[this.buildIndex(a,n)]=!0);this.errorCell=new O(e,t)}},{key:"pushCell",value:function(e,t){if(this.assertInBounds(e,t),this.getPushState(e,t))return!1;var n=this.getCellContent(e,t);if("bomb"===n)return this.switchToFailState(e,t),!0;var a=[new O(e,t)];if(0===n)for(var r=[new O(e,t)],i=[];r.length>0;){var o=r.pop();i.push(o);var l=!0,c=!1,s=void 0;try{for(var u,h=this.buildNeighbors(o.x,o.y)[Symbol.iterator]();!(l=(u=h.next()).done);l=!0){var f=u.value;S(i,f)||(a.push(f),0===this.getCellContent(f.x,f.y)&&r.push(f))}}catch(p){c=!0,s=p}finally{try{l||null==h.return||h.return()}finally{if(c)throw s}}}for(var g=0,v=a;g<v.length;g++){var m=v[g],d=m.x,b=m.y;this.pushState[this.buildIndex(d,b)]=!0}return this.clearFlag(a),!1}},{key:"assertInBounds",value:function(e,t){if(!this.checkInBounds(e,t))throw new Error("board out of bounds")}},{key:"checkInBounds",value:function(e,t){return e>=0&&t>=0&&e<this.width&&t<this.height}}]),e}();function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(n,!0).forEach((function(t){Object(y.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var F=function(e,t,n){var a=e.get(t);if(!a)return n;var r=parseInt(a,10);return Number.isNaN(r)?n:r},B=function(){var e=window.location.search,t=new URLSearchParams(e),n=F(t,"width",9),r=F(t,"height",9),i=F(t,"bombs",10);return{board:new j(n,r,i),gameState:a.playing,startDate:0}},I=B();function L(e){return e.gameState!==a.playing||void 0!==e.startDate&&"number"!==typeof e.startDate?e:N({},e,{startDate:new Date})}var P,W=Object(p.b)({game:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case s:return e.gameState===a.playing?L(function(e,t,n){var r=e.board.clone();return r.pushCell(t,n)?{board:r,gameState:a.overLose}:r.isWin()?{board:r,gameState:a.overWin}:{board:r,gameState:a.playing,startDate:e.startDate}}(e,t.x,t.y)):e;case u:return e.gameState===a.playing?L(function(e,t,n){if(e.board.getPushState(t,n))return e;var a=e.board.clone(),r=a.isFlagged(t,n);return a.setFlag(t,n,!r),N({},e,{board:a})}(e,t.x,t.y)):e;case h:return B();default:return e}},tools:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{leftClickFlag:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f:return{leftClickFlag:t.leftClickFlag};default:return e}}});n(27);!function(e){e[e.Flag=0]="Flag",e[e.Bomb=1]="Bomb",e[e.RedBomb=2]="RedBomb"}(P||(P={}));var D=function(e){var t=["cell"];if(e.pushed&&t.push("pushed"),void 0!==e.state)switch(e.state){case P.Flag:t.push("flag");break;case P.Bomb:t.push("bomb");break;case P.RedBomb:t.push("bomb"),t.push("red")}var n=null;void 0!==e.value&&(n=i.a.createElement("p",null,e.value),t.push("cell".concat(e.value)));return i.a.createElement("div",{className:t.join(" "),onClick:function(){return e.onClick&&e.onClick()},onContextMenu:function(t){e.onRightClick&&(t.preventDefault(),e.onRightClick())}},n)},T=(n(28),function(e){return e.game.board}),A=function(e){var t=Object(c.b)(),n=Object(c.c)((function(e){return e.tools.leftClickFlag})),a=function(e,t,n){var a={pushed:!1,value:void 0,state:void 0};if(a.pushed=e.getPushState(t,n),a.pushed){var r=e.getCellContent(t,n);"number"===typeof r?r>0&&(a.value=r):e.errorCell&&e.errorCell.isEqualTo(new O(t,n))?a.state=P.RedBomb:a.state=P.Bomb}else e.isFlagged(t,n)&&(a.state=P.Flag);return a}(e.board,e.x,e.y);return i.a.createElement("td",null,i.a.createElement(D,{pushed:a.pushed,value:a.value,state:a.state,onClick:function(){var a,r;t(n?g(e.x,e.y):(a=e.x,r=e.y,{type:s,x:a,y:r}))},onRightClick:function(){t(g(e.x,e.y))}}))},R=function(){var e=Object(c.c)(T),t=C(e.height).map((function(t){return i.a.createElement("tr",{key:t},C(e.width).map((function(n){return i.a.createElement(A,{key:n,board:e,x:n,y:t})})))}));return i.a.createElement("table",null,i.a.createElement("tbody",null,t))},_=(n(29),function(e){return i.a.createElement("a",{className:"btn select",href:"?width=".concat(e.width,"&height=").concat(e.height,"&bombs=").concat(e.bombs)},e.title)}),M=function(e){var t=Object(c.b)(),n="btn tool";e.active&&(n+=" active");return i.a.createElement("p",{className:n,onClick:function(){var n;t((n=e.targetConfig,{type:f,leftClickFlag:n}))}},e.title)},G=function(){var e=Object(c.c)((function(e){return e.tools.leftClickFlag}));return i.a.createElement("div",{className:"config"},i.a.createElement("div",{className:"config-box"},i.a.createElement("div",null,i.a.createElement("p",{className:"config-label"},"New game"),i.a.createElement("div",{className:"btn-group"},i.a.createElement(_,{title:"easy",width:9,height:9,bombs:10}),i.a.createElement(_,{title:"medium",width:16,height:16,bombs:40}),i.a.createElement(_,{title:"hard",width:30,height:16,bombs:99})))),i.a.createElement("div",{className:"config-box"},i.a.createElement("div",null,i.a.createElement("p",{className:"config-label"},"Touch mode"),i.a.createElement("div",{className:"btn-group"},i.a.createElement(M,{title:"open",targetConfig:!1,active:!e}),i.a.createElement(M,{title:"flag",targetConfig:!0,active:e})))))},U=(n(30),function(){var e,t;switch(Object(c.c)((function(e){return e.game.gameState}))){case a.overLose:e=["game over","you lost"],t="logo_loose.png";break;case a.overWin:e=["victory"],t="logo.png";break;default:return null}return i.a.createElement("footer",null,i.a.createElement("img",{id:"logo",alt:"logo",src:"/minesweeper/img/"+t}),i.a.createElement("div",null,e.map((function(e,t){return i.a.createElement("p",{key:t,className:"message"},e)}))))}),q=(n(31),function(){return i.a.createElement("main",null,i.a.createElement(G,null),i.a.createElement(R,null),i.a.createElement(U,null))}),J=Object(p.c)(W),K=function(){return i.a.createElement(c.a,{store:J},i.a.createElement(b,null),i.a.createElement(q,null))},H=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function $(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}l.a.render(i.a.createElement(K,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/minesweeper",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/minesweeper","/service-worker.js");H?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):$(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):$(t,e)}))}}()}},[[16,1,2]]]);
//# sourceMappingURL=main.e1c5b7d0.chunk.js.map